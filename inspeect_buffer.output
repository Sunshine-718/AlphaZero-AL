root@I26d4a2e09a009014f1:/hy-tmp# python tools/inspect_buffer.py
 未检测到可用中文字体，中文标题可能显示为方框。可用 --font-path 指定 .ttf/.otf。

╭────────────────────────────────────────────────────────────────────────────────── NN Model ───────────────────────────────────────────────────────────────────────────────────╮
│ params/AZ_Connect4_CNN_current.pt                                                                                                                                             │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────── 空棋盘 (turn=X) ───────────────────────────────────────────────────────────────────────────────╮
│   Policy           col0:  0.7%  col1:  0.9%  col2:  8.1%  col3: 80.5%  col4:  7.8%  col5:  1.0%  col6:  0.8%                                                                  │
│   Value (3-way)    Draw: 24.9%  P1win: 57.7%  P2win: 17.4%                                                                                                                    │
│   Scalar value      0.4031                                                                                                                                                    │
│   Entropy          0.7456                                                                                                                                                     │
│   Steps top-5      s=42:27.8%, s=39:17.5%, s=35:6.5%, s=37:5.7%, s=41:5.3%                                                                                                    │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭────────────────────────────────────────────────────────────────────────── X 下中间列后 (O) (turn=O) ──────────────────────────────────────────────────────────────────────────╮
│   Policy           col0:  0.9%  col1:  1.2%  col2: 31.4%  col3: 32.0%  col4: 32.4%  col5:  1.2%  col6:  1.0%                                                                  │
│   Value (3-way)    Draw: 21.9%  P1win: 67.5%  P2win: 10.6%                                                                                                                    │
│   Scalar value     -0.5686                                                                                                                                                    │
│   Entropy          1.2836                                                                                                                                                     │
│   Steps top-5      s=41:24.6%, s=38:23.2%, s=34:7.9%, s=32:7.0%, s=36:5.6%                                                                                                    │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯

╭─────────────────────────────────────────────────────────────────────────────── Buffer Metadata ───────────────────────────────────────────────────────────────────────────────╮
│   File                dataset/dataset.pt                                                                                                                                      │
│   File size           14.88 MB                                                                                                                                                │
│   Memory footprint    14.88 MB                                                                                                                                                │
│   Capacity            100000                                                                                                                                                  │
│   ptr                 3429494                                                                                                                                                 │
│   Valid samples       100000  (100.0%)                                                                                                                                        │
│   Buffer full         Yes                                                                                                                                                     │
│   ptr wrapped         Yes                                                                                                                                                     │
│                                                                                                                                                                               │
│     state             [100000, 3, 6, 7]  dtype=torch.int8                                                                                                                     │
│     prob              [100000, 7]  dtype=torch.float32                                                                                                                        │
│     winner            [100000, 1]  dtype=torch.int8                                                                                                                           │
│     steps_to_end      [100000, 1]  dtype=torch.int8                                                                                                                           │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
Global Winner Distribution 
┏━━━━━━━━━┳━━━━━━━┳━━━━━━━┓
┃ Winner  ┃ Count ┃     % ┃
┡━━━━━━━━━╇━━━━━━━╇━━━━━━━┩
│ P1 wins │ 52054 │  52.1 │
│ P2 wins │ 16663 │  16.7 │
│ Draw    │ 31283 │  31.3 │
└─────────┴───────┴───────┘
     Global     
  Steps-to-End  
┏━━━━━━┳━━━━━━━┓
┃ Stat ┃ Value ┃
┡━━━━━━╇━━━━━━━┩
│ Mean │  18.6 │
│ Std  │  11.6 │
│ Min  │     0 │
│ Max  │    42 │
└──────┴───────┘
       Global Policy Entropy        
┏━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃ Stat                    ┃  Value ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│ Mean                    │ 0.6788 │
│ Std                     │ 0.5083 │
│ Min                     │ 0.0000 │
│ Max                     │ 1.9288 │
│ Concentration (max>80%) │  46.4% │
└─────────────────────────┴────────┘
╭─────────────────────────────────────────────────────────────────────────────── 空棋盘 (turn=X) ───────────────────────────────────────────────────────────────────────────────╮
│   样本数            2748                                                                                                                                                      │
│   Match ratio       2.75% of buffer                                                                                                                                           │
│   Steps-to-end      mean=35.4, std=8.1, min=7, max=42                                                                                                                         │
│   Policy entropy    mean=0.5434, std=0.2401                                                                                                                                   │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
    Winner Distribution    
┏━━━━━━━━━┳━━━━━━━┳━━━━━━━┓
┃ Winner  ┃ Count ┃     % ┃
┡━━━━━━━━━╇━━━━━━━╇━━━━━━━┩
│ P1 wins │  1534 │  55.8 │
│ P2 wins │   487 │  17.7 │
│ Draw    │   727 │  26.5 │
└─────────┴───────┴───────┘
                     Policy 均值 ± std                      
┏━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━┓
┃ col0  ┃ col1  ┃  col2  ┃  col3  ┃  col4  ┃ col5  ┃ col6  ┃
┡━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━┩
│ 1.2%  │ 1.1%  │  8.6%  │ 78.7%  │  8.4%  │ 1.0%  │ 1.1%  │
│ ±3.4% │ ±2.3% │ ±16.2% │ ±23.0% │ ±15.8% │ ±1.9% │ ±2.6% │
└───────┴───────┴────────┴────────┴────────┴───────┴───────┘
                                                    前 10 条样本                                                     
┏━━━━━┳━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ idx ┃  winner ┃ steps ┃ policy                                                                                    ┃
┡━━━━━╇━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│  25 │ P1 wins │    39 │ col0:  1.0%  col1:  1.0%  col2:  1.0%  col3: 86.9%  col4:  9.1%  col5:  0.0%  col6:  1.0% │
│  65 │ P1 wins │    33 │ col0:  1.0%  col1:  1.0%  col2:  1.0%  col3: 85.9%  col4: 11.1%  col5:  0.0%  col6:  0.0% │
│  99 │    Draw │    42 │ col0:  0.0%  col1:  0.0%  col2: 96.0%  col3:  0.0%  col4:  2.0%  col5:  1.0%  col6:  1.0% │
│ 142 │ P1 wins │    39 │ col0:  1.0%  col1:  1.0%  col2: 20.2%  col3: 72.7%  col4:  2.0%  col5:  1.0%  col6:  2.0% │
│ 182 │ P1 wins │    41 │ col0:  1.0%  col1:  1.0%  col2:  6.1%  col3: 87.9%  col4:  3.0%  col5:  1.0%  col6:  0.0% │
│ 224 │ P1 wins │    39 │ col0:  0.0%  col1:  0.0%  col2:  2.0%  col3: 81.8%  col4: 15.2%  col5:  0.0%  col6:  1.0% │
│ 264 │ P1 wins │    37 │ col0:  0.0%  col1:  1.0%  col2:  9.1%  col3: 82.8%  col4:  6.1%  col5:  1.0%  col6:  0.0% │
│ 302 │    Draw │    42 │ col0:  0.0%  col1:  1.0%  col2: 15.2%  col3: 80.8%  col4:  1.0%  col5:  1.0%  col6:  1.0% │
│ 345 │ P1 wins │    41 │ col0:  1.0%  col1:  1.0%  col2:  0.0%  col3: 76.8%  col4: 20.2%  col5:  1.0%  col6:  0.0% │
│ 387 │ P1 wins │    31 │ col0:  1.0%  col1:  1.0%  col2:  1.0%  col3: 83.8%  col4: 11.1%  col5:  1.0%  col6:  1.0% │
└─────┴─────────┴───────┴───────────────────────────────────────────────────────────────────────────────────────────┘
    [saved] tools/figures/empty_board_X.png

╭────────────────────────────────────────────────────────────────────────── X 下中间列后 (O) (turn=O) ──────────────────────────────────────────────────────────────────────────╮
│   样本数            2173                                                                                                                                                      │
│   Match ratio       2.17% of buffer                                                                                                                                           │
│   Steps-to-end      mean=34.1, std=8.1, min=6, max=41                                                                                                                         │
│   Policy entropy    mean=1.0290, std=0.2481                                                                                                                                   │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
    Winner Distribution    
┏━━━━━━━━━┳━━━━━━━┳━━━━━━━┓
┃ Winner  ┃ Count ┃     % ┃
┡━━━━━━━━━╇━━━━━━━╇━━━━━━━┩
│ P1 wins │  1425 │  65.6 │
│ P2 wins │   248 │  11.4 │
│ Draw    │   500 │  23.0 │
└─────────┴───────┴───────┘
                     Policy 均值 ± std                      
┏━━━━━━━┳━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━┳━━━━━━━┓
┃ col0  ┃ col1  ┃  col2  ┃  col3  ┃  col4  ┃ col5  ┃ col6  ┃
┡━━━━━━━╇━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━╇━━━━━━━┩
│ 1.2%  │ 1.3%  │ 32.8%  │ 30.2%  │ 32.1%  │ 1.2%  │ 1.1%  │
│ ±2.7% │ ±1.4% │ ±23.7% │ ±21.4% │ ±23.2% │ ±1.4% │ ±2.1% │
└───────┴───────┴────────┴────────┴────────┴───────┴───────┘
                                                    前 10 条样本                                                     
┏━━━━━┳━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ idx ┃  winner ┃ steps ┃ policy                                                                                    ┃
┡━━━━━╇━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│  26 │ P1 wins │    38 │ col0:  0.0%  col1:  3.8%  col2: 62.7%  col3: 16.8%  col4: 15.7%  col5:  1.1%  col6:  0.0% │
│  66 │ P1 wins │    32 │ col0:  0.5%  col1:  1.6%  col2: 17.9%  col3: 32.1%  col4: 27.7%  col5:  0.5%  col6: 19.6% │
│ 143 │ P1 wins │    38 │ col0:  0.0%  col1:  2.9%  col2: 27.5%  col3: 25.7%  col4: 37.4%  col5:  1.8%  col6:  4.7% │
│ 183 │ P1 wins │    40 │ col0:  0.0%  col1:  0.5%  col2: 39.8%  col3: 23.7%  col4: 32.8%  col5:  2.7%  col6:  0.5% │
│ 225 │ P1 wins │    38 │ col0:  0.0%  col1:  0.6%  col2: 15.0%  col3: 70.6%  col4: 12.8%  col5:  0.0%  col6:  1.1% │
│ 265 │ P1 wins │    36 │ col0:  3.3%  col1:  0.6%  col2: 15.5%  col3: 50.3%  col4: 29.3%  col5:  1.1%  col6:  0.0% │
│ 303 │    Draw │    41 │ col0:  0.0%  col1:  0.0%  col2:  4.5%  col3:  7.3%  col4: 85.5%  col5:  2.2%  col6:  0.6% │
│ 346 │ P1 wins │    40 │ col0:  0.0%  col1:  0.6%  col2: 66.9%  col3: 28.0%  col4:  4.0%  col5:  0.6%  col6:  0.0% │
│ 388 │ P1 wins │    30 │ col0:  0.0%  col1:  0.5%  col2: 45.1%  col3: 30.8%  col4: 20.3%  col5:  3.3%  col6:  0.0% │
│ 420 │ P1 wins │    30 │ col0:  2.7%  col1:  0.5%  col2:  3.3%  col3: 33.7%  col4: 57.6%  col5:  1.1%  col6:  1.1% │
└─────┴─────────┴───────┴───────────────────────────────────────────────────────────────────────────────────────────┘
    [saved] tools/figures/after_center_O.png